	/**
	 * Create a class that contains an annotation that generates another class, 
	 * and compile it.  Verify that generation and compilation succeeded.
	 */
	private void compileOneClass(JavaCompiler compiler) {
		StandardJavaFileManager manager = compiler.getStandardFileManager(null, Locale.getDefault(), Charset.defaultCharset());
		ForwardingJavaFileManager<StandardJavaFileManager> forwardingJavaFileManager = getForwardingFileManager(manager);

		File inputFile = writeSourceFile(_tmpSrcFolderName, "X.java", _echoSource);
		
		// create new list containing inputfile
		List<File> files = new ArrayList<File>();
		files.add(inputFile);
		Iterable<? extends JavaFileObject> units = manager.getJavaFileObjectsFromFiles(files);
		StringWriter stringWriter = new StringWriter();
		PrintWriter printWriter = new PrintWriter(stringWriter);
		
		List<String> options = new ArrayList<String>();
		if (compiler == _eclipseCompiler) {
			options.add("-6.0"); // not the default for Eclipse compiler
		}
		options.add("-d");
		options.add(_tmpBinFolderName);
		options.add("-s");
		options.add(_tmpGenFolderName);
		options.add("-cp");
		options.add(_tmpSrcFolderName + File.pathSeparator + _tmpGenFolderName + File.pathSeparator + _processorJarName);
		options.add("-XprintRounds");
 		CompilationTask task = compiler.getTask(printWriter, forwardingJavaFileManager, null, options, null, units);
		Boolean result = task.call();
		
 		if (!result.booleanValue()) {
 			System.err.println("Compilation failed: " + stringWriter.getBuffer().toString());
 	 		assertTrue("Compilation failed ", false);
 		}
		// check that the src and class files were generated
 		File genSrcFile = new File(_tmpGenFolderName + File.separator + "gen" + File.separator + "XGen.java");
 		assertTrue("generated src file does not exist", genSrcFile.exists());
 		File classFile = new File(_tmpBinFolderName + File.separator + "p" + File.separator + "X.class");
 		assertTrue("ordinary src file was not compiled", classFile.exists());
 		File genClassFile = new File(_tmpBinFolderName + File.separator + "gen" + File.separator + "XGen.class");
 		assertTrue("generated src file was not compiled", genClassFile.exists());
	}

