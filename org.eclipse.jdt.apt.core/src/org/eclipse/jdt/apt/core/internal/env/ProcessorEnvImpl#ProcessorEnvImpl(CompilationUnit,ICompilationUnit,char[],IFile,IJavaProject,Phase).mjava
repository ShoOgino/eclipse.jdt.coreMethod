    private ProcessorEnvImpl(final CompilationUnit astCompilationUnit,
			final ICompilationUnit compilationUnit, final char[] source,
			final IFile file, final IJavaProject javaProj, final Phase phase) {
		super(astCompilationUnit, file, javaProj, phase);
		// if we are in reconcile, file will be null & compilationUnit will be
		// valid
		// if we are in build, file will not be null & compilationUnit will be
		// null
		assert (phase == Phase.RECONCILE && compilationUnit != null && file == null) ||
				(phase == Phase.BUILD && compilationUnit == null && file != null) : 
				"Unexpected phase value " //$NON-NLS-1$
				+ phase;
		assert (source == null && compilationUnit != null) ||
				(source != null && compilationUnit == null) : 
				"Unexpected values for _compilationUnit and _source!"; //$NON-NLS-1$
		_source = source;
		_compilationUnit = compilationUnit;
		_allProblems = new HashMap<IFile, List<IProblem>>(4);
		_filer = new FilerImpl(this);
		initOptions(_javaProject);
	}

