	private void build(){
	
		if ( !shouldBuild() )
		{
			// tracing
			if ( AptPlugin.DEBUG ) 
			{			
				String msg;
				if ( (_factories == null || _factories.size() == 0) && _dispatchedBatchFactories.isEmpty() )
					msg = "no AnnotationProcessoryFactory instances registered."; //$NON-NLS-1$
				else
					msg = "no files to dispatch to."; //$NON-NLS-1$
				trace( "run():  leaving early because there are " + msg, //$NON-NLS-1$
					   null);
			}
			cleanupAllGeneratedFiles();
		}
		else
		{
			assert _filesWithAnnotation != null :
				   "should never be invoked unless we are in build mode!"; //$NON-NLS-1$
			
			EnvCallback buildCallback = new EnvCallback() {
				public void run(AbstractCompilationEnv env) {
					build((BuildEnv)env);
				}
			};
			
			// Construct build environment, this invokes the build inside a callback
			// in order to keep open the DOM AST pipeline
			BuildEnv.newBuildEnv( 
					_filesWithAnnotation, 
					_filesWithoutAnnotation, 
					_aptProject.getJavaProject(),
					buildCallback);
		}
	}

