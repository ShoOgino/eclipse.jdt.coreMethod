	private boolean deleteGeneratedFile(IFile fileToDelete, IFile parent, IProgressMonitor progressMonitor, boolean deleteFromParent2DerivedFiles ) 
		throws CoreException
	{
		String typeName = getTypeNameForDerivedFile( fileToDelete );
		if ( _typeName2WorkingCopy.containsKey( typeName ) )
			discardGeneratedWorkingCopy( typeName, parent );
		
		// update _parents2DerivedFiles map
		if ( deleteFromParent2DerivedFiles )
		{
			Set<IFile> derivedFiles = _parent2DerivedFiles.get( parent );

			// assertions
			if ( derivedFiles == null ) throw new RuntimeException( "derivedFiles is null and it shouldn't be");
			if ( ! derivedFiles.contains( fileToDelete )) throw new RuntimeException( "derivedFiles does not contain fileToDelete");
		
			derivedFiles.remove( fileToDelete );
		}
		
		// update _derivedFile2Parents map and delete file if it has no other parents
		Set<IFile> parents = _derivedFile2Parents.get( fileToDelete );
		
		// assertions
		if( parents == null ) throw new RuntimeException( " parents is null and it shouldn't be" );
		if( ! parents.contains( parent )) throw new RuntimeException( "parents set does not contain parent" );
		
		parents.remove( parent );
		
		boolean deleted = false;
		if ( parents.size() == 0 )
		{
			fileToDelete.delete( true, true, progressMonitor );
			deleted = true;
		}
		return deleted;
	}

