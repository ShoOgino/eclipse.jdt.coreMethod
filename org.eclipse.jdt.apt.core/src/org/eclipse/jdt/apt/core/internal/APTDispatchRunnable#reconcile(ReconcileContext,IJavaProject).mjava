	private void reconcile(final ReconcileContext reconcileContext,
			   IJavaProject javaProject)
	{
		if (_factories.size() == 0) {
			if (AptPlugin.DEBUG)
				trace("runAPT: leaving early because there are no factories", //$NON-NLS-1$
						null);
			return;
		}

		EnvCallback callback = new EnvCallback() {
			public void run(AbstractCompilationEnv env) {
				
				dispatchToFileBasedProcessor(env);
				final List<? extends CategorizedProblem> problemList = env.getProblems();
				final int numProblems = problemList.size();
				if (numProblems > 0) {
					final CategorizedProblem[] aptCatProblems = new CategorizedProblem[numProblems];
					reconcileContext.putProblems(
					AptPlugin.APT_COMPILATION_PROBLEM_MARKER, problemList
							.toArray(aptCatProblems));
				}
				env.close();
			}
		};
		
		// Construct a reconcile time environment. This will do invoke
		// dispatch from inside the callback.
		AbstractCompilationEnv.newReconcileEnv(reconcileContext, callback);

	}	

