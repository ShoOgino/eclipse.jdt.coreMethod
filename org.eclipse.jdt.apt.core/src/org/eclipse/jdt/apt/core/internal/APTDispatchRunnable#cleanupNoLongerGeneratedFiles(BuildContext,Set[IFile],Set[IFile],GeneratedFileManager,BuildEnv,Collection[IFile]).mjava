	// Note: This is written to work only in build phase since we are only generating
	//       types during build phase.
	//       Do not call unless caller is sure this is during build phase.
	private void cleanupNoLongerGeneratedFiles(
			BuildContext parent,
			Set<IFile> lastGeneratedFiles, 
			Set<IFile> newGeneratedFiles,
			GeneratedFileManager gfm,		
			BuildEnv processorEnv,
			Collection<IFile> deleted)
	{	
		final int numLastGeneratedFiles = lastGeneratedFiles.size();
		// make a copy into an array to avoid concurrent modification exceptions
		IFile[] files = lastGeneratedFiles.toArray( new IFile[ numLastGeneratedFiles ] );
		
		for ( IFile f : files )
		{
			if ( ! newGeneratedFiles.contains( f ) )
			{
				final IFile parentFile = parent.getFile();
				if ( AptPlugin.DEBUG ) 
					trace( "runAPT:  File " + f + " is no longer a generated file for " + parentFile,  //$NON-NLS-1$ //$NON-NLS-2$
							processorEnv );
				try
				{
					if ( gfm.deleteGeneratedFile( f, parentFile, null ) )
						deleted.add( f );
				}
				catch ( CoreException ce )
				{
					AptPlugin.log(ce, "Could not clean up generated files"); //$NON-NLS-1$
				}
			}
		}
	}

