protected void tearDown() {
	if (context != null) {
		LocalVirtualMachine vm = this.launchedVM;
		if (vm != null) {
			try {
				this.target.disconnect(); // Close the socket first so that the OS resource has a chance to be freed. 
				int retry = 0;
				while (launchedVM.isRunning() && (++retry < 20)) {
					try {
						Thread.sleep(retry * 100);
					} catch (InterruptedException e) {
					}
				}
				if (launchedVM.isRunning()) {
					launchedVM.shutDown();
				}
				this.context = null;
			} catch (TargetException e) {
				throw new Error(e.getMessage());
			}
		}
	}
}

