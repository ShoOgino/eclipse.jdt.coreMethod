/*
 * null is not a constant
 * http://bugs.eclipse.org/bugs/show_bug.cgi?id=26138
 */
public void test009() {
	this.runConformTest(
		new String[] {
			"X.java",
			"public class X {	\n" +
			"    public static void main(String[] args) {	\n" +
			"        if (null == null) System.out.print(\"1\");	\n" +
			"        if ((null==null ? null:null) == (null==null ? null:null))	\n" +
			"        	System.out.print(\"2\");	\n" +
			"		boolean b = (\"[\" + null + \"]\") == \"[null]\";  // cannot inline	\n" +
			"		System.out.print(\"3\");	\n" +
			"		final String s = (String) null;	\n" +
			"		if (s == null) System.out.print(\"4\");	\n" +
			"		final String s2 = (String) \"aaa\";	\n" +
			"		if (s2 == \"aaa\") System.out.println(\"5\");	\n" +
			"    }	\n" +
			"}	\n",
		},
		"12345");
		
	ClassFileBytesDisassembler disassembler = ToolFactory.createDefaultClassFileBytesDisassembler();
	String actualOutput = null;
	try {
		byte[] classFileBytes = org.eclipse.jdt.internal.compiler.util.Util.getFileByteContent(new File(OUTPUT_DIR + File.separator  +"X.class"));
		actualOutput =
			disassembler.disassemble(
				classFileBytes,
				"\n",
				ClassFileBytesDisassembler.DETAILED); 
	} catch (org.eclipse.jdt.core.util.ClassFormatException e) {
		assertTrue("ClassFormatException", false);
	} catch (IOException e) {
		assertTrue("IOException", false);
	}
	
	String expectedOutput = 
		"  // Method descriptor  #15 ([Ljava/lang/String;)V\n" + 
		"  // Stack: 3, Locals: 4\n" + 
		"  public static void main(String[] args);\n" + 
		"     0  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"     3  ldc #23 <String \"1\">\n" + 
		"     5  invokevirtual #29 <Method java/io/PrintStream.print(Ljava/lang/String;)V>\n" + 
		"     8  aconst_null\n" + 
		"     9  goto 13\n" + 
		"    12  aconst_null\n" + 
		"    13  aconst_null\n" + 
		"    14  goto 18\n" + 
		"    17  aconst_null\n" + 
		"    18  if_acmpne 29\n" + 
		"    21  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"    24  ldc #31 <String \"2\">\n" + 
		"    26  invokevirtual #29 <Method java/io/PrintStream.print(Ljava/lang/String;)V>\n" + 
		"    29  new #33 java/lang/StringBuffer\n" + 
		"    32  dup\n" + 
		"    33  ldc #35 <String \"[\">\n" + 
		"    35  invokespecial #37 <Method java/lang/StringBuffer.<init>(Ljava/lang/String;)V>\n" + 
		"    38  aconst_null\n" + 
		"    39  invokevirtual #41 <Method java/lang/StringBuffer.append(Ljava/lang/Object;)Ljava/lang/StringBuffer;>\n" + 
		"    42  ldc #43 <String \"]\">\n" + 
		"    44  invokevirtual #46 <Method java/lang/StringBuffer.append(Ljava/lang/String;)Ljava/lang/StringBuffer;>\n" + 
		"    47  invokevirtual #50 <Method java/lang/StringBuffer.toString()Ljava/lang/String;>\n" + 
		"    50  ldc #52 <String \"[null]\">\n" + 
		"    52  if_acmpne 59\n" + 
		"    55  iconst_1\n" + 
		"    56  goto 60\n" + 
		"    59  iconst_0\n" + 
		"    60  istore_1\n" + 
		"    61  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"    64  ldc #54 <String \"3\">\n" + 
		"    66  invokevirtual #29 <Method java/io/PrintStream.print(Ljava/lang/String;)V>\n" + 
		"    69  aconst_null\n" + 
		"    70  astore_2\n" + 
		"    71  aload_2\n" + 
		"    72  ifnonnull 83\n" + 
		"    75  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"    78  ldc #56 <String \"4\">\n" + 
		"    80  invokevirtual #29 <Method java/io/PrintStream.print(Ljava/lang/String;)V>\n" + 
		"    83  ldc #58 <String \"aaa\">\n" + 
		"    85  astore_3\n" + 
		"    86  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"    89  ldc #60 <String \"5\">\n" + 
		"    91  invokevirtual #63 <Method java/io/PrintStream.println(Ljava/lang/String;)V>\n" + 
		"    94  return\n" + 
		"      Line numbers:\n" + 
		"        [pc: 0, line: 3]\n" + 
		"        [pc: 8, line: 4]\n" + 
		"        [pc: 21, line: 5]\n" + 
		"        [pc: 29, line: 6]\n" + 
		"        [pc: 61, line: 7]\n" + 
		"        [pc: 69, line: 8]\n" + 
		"        [pc: 71, line: 9]\n" + 
		"        [pc: 83, line: 10]\n" + 
		"        [pc: 86, line: 11]\n" + 
		"        [pc: 94, line: 12]\n" + 
		"      Local variable table:\n" + 
		"        [pc: 0, pc: 95] local: args index: 0 type: [Ljava/lang/String;\n" + 
		"        [pc: 61, pc: 95] local: b index: 1 type: Z\n" + 
		"        [pc: 71, pc: 95] local: s index: 2 type: Ljava/lang/String;\n" + 
		"        [pc: 86, pc: 95] local: s2 index: 3 type: Ljava/lang/String;\n";
	
	String expectedOutput15 =
		"  // Method descriptor  #15 ([Ljava/lang/String;)V\n" + 
		"  // Stack: 3, Locals: 4\n" + 
		"  public static void main(String[] args);\n" + 
		"     0  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"     3  ldc #23 <String \"1\">\n" + 
		"     5  invokevirtual #29 <Method java/io/PrintStream.print(Ljava/lang/String;)V>\n" + 
		"     8  aconst_null\n" + 
		"     9  goto 13\n" + 
		"    12  aconst_null\n" + 
		"    13  aconst_null\n" + 
		"    14  goto 18\n" + 
		"    17  aconst_null\n" + 
		"    18  if_acmpne 29\n" + 
		"    21  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"    24  ldc #31 <String \"2\">\n" + 
		"    26  invokevirtual #29 <Method java/io/PrintStream.print(Ljava/lang/String;)V>\n" + 
		"    29  new #33 java/lang/StringBuilder\n" + 
		"    32  dup\n" + 
		"    33  ldc #35 <String \"[\">\n" + 
		"    35  invokespecial #37 <Method java/lang/StringBuilder.<init>(Ljava/lang/String;)V>\n" + 
		"    38  aconst_null\n" + 
		"    39  invokevirtual #41 <Method java/lang/StringBuilder.append(Ljava/lang/Object;)Ljava/lang/StringBuilder;>\n" + 
		"    42  ldc #43 <String \"]\">\n" + 
		"    44  invokevirtual #46 <Method java/lang/StringBuilder.append(Ljava/lang/String;)Ljava/lang/StringBuilder;>\n" + 
		"    47  invokevirtual #50 <Method java/lang/StringBuilder.toString()Ljava/lang/String;>\n" + 
		"    50  ldc #52 <String \"[null]\">\n" + 
		"    52  if_acmpne 59\n" + 
		"    55  iconst_1\n" + 
		"    56  goto 60\n" + 
		"    59  iconst_0\n" + 
		"    60  istore_1\n" + 
		"    61  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"    64  ldc #54 <String \"3\">\n" + 
		"    66  invokevirtual #29 <Method java/io/PrintStream.print(Ljava/lang/String;)V>\n" + 
		"    69  aconst_null\n" + 
		"    70  astore_2\n" + 
		"    71  aload_2\n" + 
		"    72  ifnonnull 83\n" + 
		"    75  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"    78  ldc #56 <String \"4\">\n" + 
		"    80  invokevirtual #29 <Method java/io/PrintStream.print(Ljava/lang/String;)V>\n" + 
		"    83  ldc #58 <String \"aaa\">\n" + 
		"    85  astore_3\n" + 
		"    86  getstatic #21 <Field java/lang/System.out Ljava/io/PrintStream;>\n" + 
		"    89  ldc #60 <String \"5\">\n" + 
		"    91  invokevirtual #63 <Method java/io/PrintStream.println(Ljava/lang/String;)V>\n" + 
		"    94  return\n" + 
		"      Line numbers:\n" + 
		"        [pc: 0, line: 3]\n" + 
		"        [pc: 8, line: 4]\n" + 
		"        [pc: 21, line: 5]\n" + 
		"        [pc: 29, line: 6]\n" + 
		"        [pc: 61, line: 7]\n" + 
		"        [pc: 69, line: 8]\n" + 
		"        [pc: 71, line: 9]\n" + 
		"        [pc: 83, line: 10]\n" + 
		"        [pc: 86, line: 11]\n" + 
		"        [pc: 94, line: 12]\n" + 
		"      Local variable table:\n" + 
		"        [pc: 0, pc: 95] local: args index: 0 type: [Ljava/lang/String;\n" + 
		"        [pc: 61, pc: 95] local: b index: 1 type: Z\n" + 
		"        [pc: 71, pc: 95] local: s index: 2 type: Ljava/lang/String;\n" + 
		"        [pc: 86, pc: 95] local: s2 index: 3 type: Ljava/lang/String;\n";
	
	if (COMPLIANCE_1_5.equals(this.complianceLevel)) {
		if (actualOutput.indexOf(expectedOutput15) == -1){
			System.out.println(Util.displayString(actualOutput, 2));
		}
		assertTrue("unexpected bytecode sequence", actualOutput.indexOf(expectedOutput15) != -1);
	} else {
		if (actualOutput.indexOf(expectedOutput) == -1){
			System.out.println(Util.displayString(actualOutput, 2));
		}
		assertTrue("unexpected bytecode sequence", actualOutput.indexOf(expectedOutput) != -1);
	}
}

