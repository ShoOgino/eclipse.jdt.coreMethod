	private void runTest(DefaultCodeFormatter codeFormatter, String packageName, String compilationUnitName, int kind, int indentationLevel, boolean checkNull, int offset, int length) {
		try {
				ICompilationUnit sourceUnit = getCompilationUnit("Formatter" , "", packageName, getIn(compilationUnitName)); //$NON-NLS-1$ //$NON-NLS-2$
				String s = sourceUnit.getSource();
				assertNotNull(s);
				ICompilationUnit outputUnit = getCompilationUnit("Formatter" , "", packageName, getOut(compilationUnitName)); //$NON-NLS-1$ //$NON-NLS-2$
				assertNotNull(outputUnit);
				String result;
				if (length == -1) {
					result = runFormatter(codeFormatter, s, kind, indentationLevel, offset, s.length());
				} else {
					result = runFormatter(codeFormatter, s, kind, indentationLevel, offset, length);
				}
				assertLineEquals(result, s, outputUnit.getSource(), checkNull);
		} catch (JavaModelException e) {
			e.printStackTrace();
			assertTrue(false);
		}
	}

