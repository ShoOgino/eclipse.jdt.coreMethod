public void testBug36032b() throws CoreException {
	try {
		createJavaProject("P", new String[] {""}, new String[] {"JCL_LIB"}, "bin");
		String source = 
			"public class Test {\n" + 
			"	public static void main(String[] args) {\n" + 
			"		new SFoo().foo();\n" + 
			"		new SBar().bar();\n" + 
			"	}\n" + 
			"}\n";
		createFile(
			"/P/Foo.java", 
			"class SFoo { void foo() {} }\n"
		);
		createFile(
			"/P/Test.java", 
			source
		);
		createFile(
			"/P/Bar.java", 
			"class SBar{ void bar() {} }\n"
		);
		this.workingCopy = getCompilationUnit("/P/Test.java").getWorkingCopy(new WorkingCopyOwner() {}, this.problemRequestor, null);
		this.problemRequestor.initialize(source.toCharArray());
		this.workingCopy.getBuffer().setContents(source);
		this.workingCopy.reconcile(AST.JLS3, true, null, null);
		if (this.problemRequestor.problemCount > 0) {
			assertEquals("Working copy should NOT have any problem!", "", this.problemRequestor.problems.toString());
		}

		// Delete secondary type => should get a problem
		waitUntilIndexesReady();
		deleteFile("/P/Bar.java");
		this.workingCopy.reconcile(AST.JLS3, true, null, null);
		assertEquals("Working copy should not find secondary type 'Bar'!", 1, this.problemRequestor.problemCount);
		assertProblems("Working copy should have problem!",
			"----------\n" +
			"----------\n" +
			"----------\n" +
			"1. ERROR in /P/Test.java (at line 4)\n" +
			"	new SBar().bar();\n" +
			"	    ^^^^\n" +
			"SBar cannot be resolved to a type\n" +
			"----------\n"
		);

		// Fix the problem
		source = 
			"public class Test {\n" + 
			"	public static void main(String[] args) {\n" + 
			"		new SFoo().foo();\n" + 
			"	}\n" + 
			"}\n";
		this.problemRequestor.initialize(source.toCharArray());
		this.workingCopy.getBuffer().setContents(source);
		this.workingCopy.reconcile(AST.JLS3, true, null, null);
		if (this.problemRequestor.problemCount > 0) {
			assertEquals("Working copy should NOT have any problem!", "", this.problemRequestor.problems.toString());
		}
	} finally {
		deleteProject("P");
	}
}

