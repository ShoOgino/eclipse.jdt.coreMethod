public void testCommit() throws CoreException {
	ICompilationUnit original = (ICompilationUnit)this.workingCopy.getOriginalElement();
	this.assertTrue("Original element should not be null", original != null);

	IBuffer workingCopyBuffer = this.workingCopy.getBuffer();
	assertTrue("Working copy buffer should not be null", workingCopyBuffer != null);

	String newContents = 
		"public class X {\n" +
		"  public void foo() {\n" +
		"  }\n" +
		"}";
	workingCopyBuffer.setContents(newContents);
	this.workingCopy.commit(false, null);
	
	IBuffer originalBuffer = original.getBuffer();
	assertTrue("Original buffer should not be null", originalBuffer != null);
	
	this.assertEquals(
		"Unexpected contents", 
		newContents, 
		new String(originalBuffer.getCharacters()));
}

