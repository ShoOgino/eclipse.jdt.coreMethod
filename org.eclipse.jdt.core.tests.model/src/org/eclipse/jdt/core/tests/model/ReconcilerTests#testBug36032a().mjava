/**
 * Bug 36032:[plan] JavaProject.findType() fails to find second type in source file
 * @see "https://bugs.eclipse.org/bugs/show_bug.cgi?id=36032"
 *
 */
public void testBug36032a() throws CoreException {
	try {
		createJavaProject("P", new String[] {""}, new String[] {"JCL_LIB"}, "bin");
		String source = 
			"public class Test {\n" + 
			"	public static void main(String[] args) {\n" + 
			"		new SFoo().foo();\n" + 
			"	}\n" + 
			"}\n";
		this.createFile(
			"/P/Foo.java", 
			"class SFoo { void foo() {} }\n"
		);
		this.createFile(
			"/P/Test.java", 
			source
		);
		this.workingCopy = getCompilationUnit("/P/Test.java").getWorkingCopy(new WorkingCopyOwner() {}, problemRequestor, null);
		this.problemRequestor.initialize(source.toCharArray());
		this.workingCopy.getBuffer().setContents(source);
		this.workingCopy.reconcile(AST.JLS3, true, null, null);
		if (this.problemRequestor.problemCount > 0) {
			assertEquals("Working copy should NOT have any problem!", "", this.problemRequestor.problems.toString());
		}

		// Add new secondary type
		this.createFile(
			"/P/Bar.java", 
			"class SBar{ void bar() {} }\n"
		);
		waitUntilIndexesReady();
		source = 
			"public class Test {\n" + 
			"	public static void main(String[] args) {\n" + 
			"		new SFoo().foo();\n" + 
			"		new SBar().bar();\n" + 
			"	}\n" + 
			"}\n";
		this.problemRequestor.initialize(source.toCharArray());
		this.workingCopy.getBuffer().setContents(source);
		this.workingCopy.reconcile(AST.JLS3, true, null, null);
		if (this.problemRequestor.problemCount > 0) {
			assertEquals("Working copy should NOT have any problem!", "", this.problemRequestor.problems.toString());
		}
	} finally {
		deleteProject("P");
	}
}

