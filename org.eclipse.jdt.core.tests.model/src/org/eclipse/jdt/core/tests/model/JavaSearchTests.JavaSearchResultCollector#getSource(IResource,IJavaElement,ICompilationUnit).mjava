	protected char[] getSource(IResource resource, IJavaElement element, ICompilationUnit unit) throws JavaModelException {
		char[] contents = CharOperation.NO_CHAR;
		if ("java".equals(resource.getFileExtension())) {
			ICompilationUnit cu = (ICompilationUnit)element.getAncestor(IJavaElement.COMPILATION_UNIT);
			if (cu != null && cu.isWorkingCopy()) {
				// working copy
				contents = unit.getBuffer().getCharacters();
			} else {
				contents = new org.eclipse.jdt.internal.compiler.batch.CompilationUnit(
					null, 
					((IFile) resource).getLocation().toFile().getPath(),
					null).getContents();
			}
		}
		return contents;
	}

