/*
 * Ensure that removing the outer folder from the classpath doesn't remove cus in inner folder
 * from index
 * (regression test for bug 32607 Removing outer folder removes nested folder's cus from index)
 */
public void testRemoveOuterFolder() throws CoreException {
	try {
		// setup: one cu in a nested source folder
		JavaCore.run(new IWorkspaceRunnable() {
			public void run(IProgressMonitor monitor) throws CoreException {
				IJavaProject project = createJavaProject("P");
				project.setRawClasspath(
					createClasspath(new String[] {"/P/src1", "src2/", "/P/src1/src2", ""}), 
					new Path("/P/bin"),
					null);
				createFolder("/P/src1/src2");
				createFile(
					"/P/src1/src2/X.java",
					"public class X {\n" +
					"}"
				);
			}
		}, null);
		assertAllTypes(
			"Unexpected all types after setup",
			"X"
		);
		
		// remove outer folder from classpath
		getJavaProject("P").setRawClasspath(
			createClasspath(new String[] {"/P/src1/src2", ""}), 
			null);
		assertAllTypes(
			"Unexpected all types after removing outer folder",
			"X"
		);
		
	} finally {
		deleteProject("P");
	}
}

