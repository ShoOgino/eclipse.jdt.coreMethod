/*
 * Search all type names in working copies test.
 * (Regression test for bug 40793 Primary working copies: Type search does not find type in modified CU)
 */
public void testAllTypeNames1() throws CoreException {
	this.workingCopy.getBuffer().setContents(
		"package wc;\n" +
		"public class Y {\n" +
		"  interface I {\n" +
		"  }\n" +
		"}" 
	);
	this.workingCopy.makeConsistent(null);
	IJavaSearchScope scope = SearchEngine.createJavaSearchScope(new IJavaElement[] {this.workingCopy.getParent()});
	SearchTests.TypeNameRequestor requestor = new SearchTests.TypeNameRequestor();
	new SearchEngine(new IWorkingCopy[] {this.workingCopy}).searchAllTypeNames(
		ResourcesPlugin.getWorkspace(),
		null,
		null,
		PATTERN_MATCH,
		CASE_INSENSITIVE,
		TYPE,
		scope, 
		requestor,
		IJavaSearchConstants.WAIT_UNTIL_READY_TO_SEARCH,
		null		
	);
	assertEquals(
		"Unexpected all type names",
		"wc.Y\n" +
		"wc.Y$I",
		requestor.toString());
}

