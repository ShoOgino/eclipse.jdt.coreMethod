protected void assertMarkers(String message, String expectedMarkers, IJavaProject project) throws CoreException {
	try { // wait for autobuild notification to occur
		Platform.getJobManager().join(ResourcesPlugin.FAMILY_AUTO_BUILD, null);
	} catch (OperationCanceledException e) {
	} catch (InterruptedException e) {
	}
	IMarker[] markers = project.getProject().findMarkers(IJavaModelMarker.BUILDPATH_PROBLEM_MARKER, false, IResource.DEPTH_ZERO);
	this.sortMarkers(markers);
	StringBuffer buffer = new StringBuffer();
	for (int i = 0, length = markers.length; i < length; i++) {
		IMarker marker = markers[i];
		buffer.append(marker.getAttribute(IMarker.MESSAGE));
		if (i != length-1) {
			buffer.append("\n");
		}
	}
	String actual = buffer.toString();
	if (!expectedMarkers.equals(actual)) {
	 	System.out.println(Util.displayString(actual, 2));
	}
	assertEquals(message, expectedMarkers, actual);
}

