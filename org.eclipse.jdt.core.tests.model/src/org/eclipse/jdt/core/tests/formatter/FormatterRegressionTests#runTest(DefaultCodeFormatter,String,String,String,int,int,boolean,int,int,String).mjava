	private void runTest(DefaultCodeFormatter codeFormatter, String sourceIn, String packageName, String compilationUnitName, int kind, int indentationLevel, boolean checkNull, int offset, int length, String lineSeparator) {
		try {
			assertNotNull(sourceIn);
			ICompilationUnit outputUnit = getCompilationUnit("Formatter" , "", packageName, getOut(compilationUnitName)); //$NON-NLS-1$ //$NON-NLS-2$
			assertNotNull(outputUnit);
			String result;
			if (length == -1) {
				result = runFormatter(codeFormatter, sourceIn, kind, indentationLevel, offset, sourceIn.length(), lineSeparator);
			} else {
				result = runFormatter(codeFormatter, sourceIn, kind, indentationLevel, offset, length, lineSeparator);
			}
			assertLineEquals(result, sourceIn, outputUnit.getSource(), checkNull);
		} catch (JavaModelException e) {
			e.printStackTrace();
			assertTrue(false);
		}
	}

