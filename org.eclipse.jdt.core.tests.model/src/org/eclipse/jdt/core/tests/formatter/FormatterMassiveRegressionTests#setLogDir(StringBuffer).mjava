private static void setLogDir(StringBuffer buffer) {

	// Compute log dir
	File logDir = new File(System.getProperty("logDir"));
	if (!logDir.exists()) {
		return;
	}

	// Compute log sub-directories depending on profiles
	logDir = new File(logDir, ECLIPSE_VERSION);
	if (PATCH_BUG != null) {
		logDir = new File(logDir, "tests");
		logDir = new File(logDir, PATCH_BUG);
	} else if (JDT_CORE_HEAD) {
		logDir = new File(logDir, "HEAD");
	} else {
		logDir = new File(logDir, ECLIPSE_MILESTONE);
		logDir = new File(logDir, JDT_CORE_VERSION);
	}
	if (NO_COMMENTS || BRACES != null || JOIN_LINES != null) {
		logDir = new File(logDir, "profiles");
		if (JOIN_LINES != null) {
			logDir = new File(new File(logDir, "join_lines"), JOIN_LINES);
		}
		if (NO_COMMENTS) {
			logDir = new File(logDir, "no_comments");
		}
		if (BRACES != null) {
			logDir = new File(new File(logDir, "braces"), BRACES);
		}
	}
	
	// Create log stream
	logDir.mkdirs();
	String logFileName = INPUT_DIR.getName().replaceAll("\\.", "")+".txt";
	LOG_FILE = new File(logDir, logFileName);
	buffer.append("Log file  : ");
	buffer.append(LOG_FILE);
	buffer.append(LINE_SEPARATOR);
	try {
		if (LOG_FILE.exists()) {
			Util.delete(LOG_FILE);
		}
		LOG_STREAM = new PrintStream(new BufferedOutputStream(new FileOutputStream(LOG_FILE)));
	}
	catch (FileNotFoundException fnfe) {
		System.err.println("Can't create log file"+LOG_FILE); //$NON-NLS-1$
	}
}

