/*
 * Test to clean the output directory.
 */
public void testClean() throws IOException, Exception {

	// Delete the output directory
	Util.delete(OUTPUT_DIR);

	// Format each file of the input dir and write the result to the output directory
	assertNotNull("We should have got input files from "+INPUT_DIR, this.inputFiles);
	DefaultCodeFormatter codeFormatter = codeFormatter();
	int length = this.inputFiles.length;
	for (int i=0; i<length; i++) {

		// Get the source from file
		String source = new String(org.eclipse.jdt.internal.compiler.util.Util.getFileCharContent(this.inputFiles[i], null));

		try {
			// Format the source
			TextEdit edit = codeFormatter.format(CodeFormatter.K_COMPILATION_UNIT | CodeFormatter.F_INCLUDE_COMMENTS, source, 0, source.length(), 0, null);

			// Write the result
			if (edit != null) {
				String formatResult = org.eclipse.jdt.internal.core.util.Util.editedString(source, edit);
				String inputPath = this.inputFiles[i].getPath().substring(INPUT_DIR.getPath().length()+1);
				File writtenFile = new Path(OUTPUT_DIR.getPath()).append(inputPath).toFile();
				writtenFile.getParentFile().mkdirs();
				Util.writeToFile(formatResult, writtenFile.getAbsolutePath());
			}
		}
		catch (Exception ex) {
			// skip silently
		}
	}
}

