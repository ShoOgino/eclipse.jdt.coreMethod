    /**
     *-----------------------------------------------------------------------------
     *
     * ParseMeridianAndSetHour --
     *
     *      Parse a meridian and sets the hour field of the calendar.
     *	A meridian is valid, if it confirms to the following yacc rule:
     *	o_merid : // NULL
     *		| tMERIDIAN
     *		;
     *
     * Results:
     *      None; parsePos was incremented and the claendar was set according
     *	to the read meridian.
     *
     * Side effects:
     *      None.
     *
     *-----------------------------------------------------------------------------
     */

    private void ParseMeridianAndSetHour(ClockToken[] dt, // Input as scanned array of tokens
            ParsePosition parsePos, // Current position in input
            Calendar calendar, // calendar object to set
            int hour) // hour value (1-12 or 0-23) to set.
    {
        int pos = parsePos.getIndex();
        int hourField;

        if (pos < dt.length && dt[pos].is(ClockToken.MERIDIAN))
            {
                calendar.set(Calendar.AM_PM, dt[pos].getInt());
                parsePos.setIndex(pos + 1);
                hourField = Calendar.HOUR;
            } else
            {
                hourField = Calendar.HOUR_OF_DAY;
            }

        if (hourField == Calendar.HOUR && hour == 12)
            {
                hour = 0;
            }
        calendar.set(hourField, hour);
    }

