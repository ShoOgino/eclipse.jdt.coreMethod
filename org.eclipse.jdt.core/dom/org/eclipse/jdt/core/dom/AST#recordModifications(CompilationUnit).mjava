	/**
	 * Enable the record of AST modifications. Recording can not be disabled.
	 * @param root top level node of the recording.
	 * @throws RewriteException if AST is already modified
	 * @throws RewriteException if record is already enabled
	 * @throws RewriteException if <code>root</code> is unmodifiable
	 * @throws RewriteException if <code>root</code> is not owned by this AST
	 * 
	 * @see org.eclipse.jdt.core.dom.rewrite.NewASTRewrite
	 * @see CompilationUnit#recordModifications()
	 * @since 3.0
	 */
	void recordModifications(CompilationUnit root) throws RewriteException {
		if(this.modificationCount != this.originalModificationCount) {
			throw new RewriteException("AST is already modified"); //$NON-NLS-1$
		} else if(this.rewriter  != null) {
			throw new RewriteException("AST modifications are already recorded"); //$NON-NLS-1$
		} else if((root.getFlags() & ASTNode.PROTECT) != 0) {
			throw new RewriteException("Root node is unmodifiable"); //$NON-NLS-1$
		} else if(root.getAST() != this) {
			throw new RewriteException("Root node is not owned by this ast"); //$NON-NLS-1$
		}
		
		this.rewriter = new InternalASTRewrite(root);
		this.setEventHandler(this.rewriter);
	}

