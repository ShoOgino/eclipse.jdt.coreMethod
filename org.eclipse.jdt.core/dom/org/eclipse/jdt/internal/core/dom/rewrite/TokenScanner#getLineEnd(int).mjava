	private int getLineEnd(int line) throws CoreException {
		if (this.document != null) {
			try {
				IRegion region= this.document.getLineInformation(line);
				return region.getOffset() + region.getLength();
			} catch (BadLocationException e) {
				String message= "Illegal line: " + line; //$NON-NLS-1$
				throw new CoreException(createError(DOCUMENT_ERROR, message, e));
			}
		}
		return getScanner().getLineEnd(line);
	}			

