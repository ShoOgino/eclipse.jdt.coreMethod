	/**
	 * If toEnqueue has children, they are enqueued in the given queue. If it is directly indexable,
	 * it is added to the result.
	 */
	private void enqueue(List<IJavaElement> result, ArrayDeque<IJavaElement> queue,
			IJavaElement toEnqueue) throws JavaModelException {
		if (toEnqueue.getElementType() == IJavaElement.COMPILATION_UNIT
				|| toEnqueue.getElementType() == IJavaElement.CLASS_FILE) {
			result.add(toEnqueue);
		} else if (toEnqueue instanceof IParent) {
			IParent parent = (IParent) toEnqueue;

			for (IJavaElement child : parent.getChildren()) {
				queue.add(child);
			}

			// We need to call isInvalidArchive after the call to getChildren, since the invalid state
			// is only initialized in the call to getChildren.
			if (!JavaModelManager.getJavaModelManager().getArchiveValidity(toEnqueue.getPath()).isValid()) {
				throw new JavaModelException(new RuntimeException(), IJavaModelStatusConstants.IO_EXCEPTION);
			}
		}
	}

