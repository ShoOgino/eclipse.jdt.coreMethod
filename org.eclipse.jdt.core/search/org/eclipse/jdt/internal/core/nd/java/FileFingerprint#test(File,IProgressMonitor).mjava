	/**
	 * Compares the given File with the receiver. If the fingerprint matches (ie: the file 
	 * 
	 * @param toTest
	 * @param monitor
	 * @return
	 * @throws IOException 
	 */
	public FingerprintTestResult test(File toTest, IProgressMonitor monitor) throws CoreException {
		SubMonitor subMonitor = SubMonitor.convert(monitor, 100);
		long lastModified = toTest.lastModified();
		subMonitor.split(5);
		
		long fileSize = toTest.length();
		subMonitor.split(5);
		if (lastModified == this.time && fileSize == this.size) {
			return new FingerprintTestResult(true, false, this);
		}

		long hashCode;
		try {
			hashCode = computeHashCode(toTest, fileSize, subMonitor.split(90));
		} catch (IOException e) {
			throw new CoreException(Package.createStatus("An error occurred computing a hash code", e));
		}
		boolean matches = (hashCode == this.hash && fileSize == this.size);

		return new FingerprintTestResult(matches, true, new FileFingerprint(lastModified, fileSize, hashCode));
	}

