	/**
	 * Saves the index in the given IndexOutput.
	 * Structure of the saved Index :
	 *   - IndexedFiles in sorted order.
	 *		+ example: 
	 *			"c:/com/Test.java 1"
	 *			"c:/com/UI.java 2"
	 *   - References with the words in sorted order
	 *		+ example: 
	 *			"classDecl/Test 1"
	 *			"classDecl/UI 2"
	 *			"ref/String 1 2"
	 */

	protected void save(IndexOutput output) throws IOException {
		boolean ok= false;
		char[][] sortedWords= getSortedWords();
		try {
			output.open();
			int numFiles= this.files.size;
			for (int i= 0; i < numFiles; ++i) {
				IndexedFile indexedFile= (IndexedFile) this.files.elementAt(i);
				output.addFile(indexedFile);
			}
			int numWords= sortedWords.length;
			for (int i= 0; i < numWords; ++i) {
				char[] word= sortedWords[i];
				WordEntry entry= (WordEntry) this.words.get(word);
				output.addWord(entry);
			}
			output.flush();
			output.close();
			ok= true;
		} finally {
			if (!ok)
				if (output != null)
					output.close();
		}
	}

