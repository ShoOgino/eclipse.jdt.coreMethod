	/**
	 * Removes the given document from the given index (MergeFactory.ADDS_INDEX for the
	 * in memory index, MergeFactory.OLD_INDEX for the index on the disk).
	 */
	protected void remove(IndexedFile file, int index) throws IOException {
		String name = file.getPath();
		if (index == MergeFactory.ADDS_INDEX) {
			Int lastRemoved = (Int) removedInAdds.get(name);
			if (lastRemoved != null) {
				if (lastRemoved.value < file.getFileNumber())
					lastRemoved.value = file.getFileNumber();
			} else
				removedInAdds.put(name, new Int(file.getFileNumber()));
		} else
			if (index == MergeFactory.OLD_INDEX)
				removedInOld.put(name, new Int(1));
			else
				throw new Error();
		state = CAN_MERGE;
	}

