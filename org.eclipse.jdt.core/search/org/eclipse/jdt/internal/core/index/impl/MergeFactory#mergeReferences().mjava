	/**
	 * Merges the files of the 2 indexes in the new index, according to the changes
	 * recorded during mergeFiles().
	 */
	protected void mergeReferences() throws IOException {
		int compare;
		while (oldInput.hasMoreWords() || addsInput.hasMoreWords()) {
			WordEntry word1= oldInput.getCurrentWordEntry();
			WordEntry word2= addsInput.getCurrentWordEntry();

			if (word1 == null && word2 == null)
				break;
			
			if (word1 == null)
				compare= 1;
			else if (word2 == null)
				compare= -1;
			else
				compare= Util.compare(word1.getWord(), word2.getWord());
			if (compare < 0) {
				word1.mapRefs(mappingOld);
				mergeOutput.addWord(word1);
				oldInput.moveToNextWordEntry();
			} else if (compare > 0) {
				word2.mapRefs(mappingAdds);
				mergeOutput.addWord(word2);
				addsInput.moveToNextWordEntry();
			} else {
				word1.mapRefs(mappingOld);
				word2.mapRefs(mappingAdds);
				word1.addRefs(word2.getRefs());
				mergeOutput.addWord(word1);
				addsInput.moveToNextWordEntry();
				oldInput.moveToNextWordEntry();
			}
		}
		mergeOutput.flushWords();
	}

