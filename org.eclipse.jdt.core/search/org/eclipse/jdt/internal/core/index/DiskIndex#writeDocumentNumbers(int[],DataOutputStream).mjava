private void writeDocumentNumbers(int[] documentNumbers, DataOutputStream stream) throws IOException {
	// must store length as a positive int to detect in-lined array of 1 element
	int length = documentNumbers.length;
	stream.writeInt(length);
	Util.sort(documentNumbers);
	switch (this.documentReferenceSize) {
		case 1 :
			for (int i = 0; i < length; i++)
				stream.writeByte(documentNumbers[i]);
			break;
		case 2 :
			for (int i = 0; i < length; i++)
				stream.writeShort(documentNumbers[i]);
			break;
		default :
			for (int i = 0; i < length; i++)
				stream.writeInt(documentNumbers[i]);
			break;
	}
}

