public void indexDocument(final SearchDocument searchDocument, final SearchParticipant searchParticipant, final IIndex index) throws IOException {
	index.add(searchDocument,
		new IIndexer() {
			public void index(SearchDocument document, IIndexerOutput output) throws IOException {
				output.addDocument(document); // Add the name of the file to the index
				String indexPath = index.getIndexFile().toString();
				try {
					indexerOutputs.put(document, output);
					searchParticipant.indexDocument(searchDocument, indexPath);
				} finally {
					indexerOutputs.remove(document);
				}
			}
		});
}

