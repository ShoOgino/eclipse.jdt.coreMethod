public void add(IJavaElement element) throws JavaModelException {
	IPackageFragmentRoot root = null;
	if (element instanceof IJavaProject) {
		this.add((IJavaProject)element, true, new HashSet(2));
	} else if (element instanceof IPackageFragmentRoot) {
		root = (IPackageFragmentRoot)element;
		this.add(root.getPath(), true);
	} else if (element instanceof IPackageFragment) {
		root = (IPackageFragmentRoot)element.getParent();
		if (root.isArchive()) {
			this.add(root.getPath().append(new Path(element.getElementName().replace('.', '/'))), false);
		} else {
			IResource resource = element.getUnderlyingResource();
			if (resource != null && resource.isAccessible()) {
				this.add(resource.getFullPath(), false);
			}
		}
	} else {
		IResource resource = element.getUnderlyingResource();
		if (resource != null && resource.isAccessible()) {
			this.add(resource.getFullPath(), true);
			
			// find package fragment root including this java element
			IJavaElement parent = element.getParent();
			while (parent != null && !(parent instanceof IPackageFragmentRoot)) {
				parent = parent.getParent();
			}
			if (parent instanceof IPackageFragmentRoot) {
				root = (IPackageFragmentRoot)parent;
			}
		}	
	}
	
	if (root != null) {
		if (root.isArchive()) {
			this.addEnclosingProjectOrJar(root.getPath());
		} else {
			this.addEnclosingProjectOrJar(root.getJavaProject().getProject().getFullPath());
		}
	}
}

