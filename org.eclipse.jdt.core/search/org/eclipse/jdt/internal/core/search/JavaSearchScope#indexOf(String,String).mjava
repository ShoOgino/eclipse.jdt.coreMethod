/**
 * Returns paths list index of given path or -1 if not found.
 */
private int indexOf(String path, String containerPath) {
	if (containerPath != null) {
		// if container path is known, use the hash to get faster comparison
		int index = (containerPath.hashCode()& 0x7FFFFFFF) % this.paths.length;
		String currentContainerPath;
		while ((currentContainerPath = this.containerPaths[index]) != null) {
			if (currentContainerPath.equals(containerPath)) {
				String scopePath = this.paths[index];
				if (encloses(scopePath, path, index))
					return index;
			}
			index = (index + 1) % this.paths.length;
		}
		return -1;
	}
	
	// fallback to sequentially look at all known paths
	for (int i = 0, length = this.paths.length; i < length; i++) {
		String scopePath = this.paths[i];
		if (scopePath == null) continue;
		if (encloses(scopePath, path, i))
			return i;
	}
	return -1;
}

