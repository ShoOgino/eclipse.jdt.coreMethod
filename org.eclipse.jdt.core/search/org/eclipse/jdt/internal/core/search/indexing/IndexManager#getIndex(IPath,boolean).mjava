/**
 * Returns the index for a given project, if none and asked for then create an empty one.
 * Note: if there is an existing index file already, it will be reused. 
 * Warning: Does not check whether index is consistent (not being used)
 */
public synchronized IIndex getIndex(IPath path, boolean mustCreate) {
	IIndex index = (IIndex) indexes.get(path);
	if (index == null) {
		try {
			// Compute canonical path
			IPath canonicalPath = JavaProject.canonicalizedPath(path);
			index = (IIndex) indexes.get(canonicalPath);
			if (!mustCreate) return index;
			if (index == null) {
				// New index: add same index for given path and canonical path
				String indexPath = computeIndexName(canonicalPath.toOSString());
				index = IndexFactory.newIndex(indexPath, "Index for " + canonicalPath.toOSString());
				indexes.put(canonicalPath, index);
				indexes.put(path, index);
				monitors.put(index, new ReadWriteMonitor());
			} else {
				// Index existed for canonical path, add it for given path
				indexes.put(path, index);
			}
		} catch (IOException e) {
			// The file could not be created. Possible reason: the project has been deleted.
			return null;
		}
	}
	//System.out.println(" index name: " + path.toOSString() + " <----> " + index.getIndexFile().getName());	
	return index;
}

