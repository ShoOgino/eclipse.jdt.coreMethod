private void rebuildIndex(String indexName, IPath path) {
	Object target = JavaModel.getTarget(ResourcesPlugin.getWorkspace().getRoot(), path, true);
	if (target == null) return;

	updateIndexState(indexName, REBUILDING_STATE);
	IndexRequest request = null;
	if (target instanceof IProject) {
		request = new IndexAllProject((IProject) target, this);
	} else if (target instanceof IFolder) {
		IFolder folder = (IFolder) target;
		request = new IndexBinaryFolder(folder, this, folder.getProject());
	} else if (target instanceof IFile) {
		request = new AddJarFileToIndex((IFile) target, this, ""); //$NON-NLS-1$
	} else if (target instanceof java.io.File) {
		// remember the timestamp of this library
		long timestamp = DeltaProcessor.getTimeStamp((java.io.File) target);
		//TODO: (jerome) why this side-effect likely breaking external JAR update support
		JavaModelManager.getJavaModelManager().deltaProcessor.externalTimeStamps.put(path, new Long(timestamp));
		request = new AddJarFileToIndex(path, this, ""); //$NON-NLS-1$
	}
	if (request != null)
		request(request);
}

