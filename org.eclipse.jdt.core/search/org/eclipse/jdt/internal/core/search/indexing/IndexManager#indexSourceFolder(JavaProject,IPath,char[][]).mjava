/**
 * Index the content of the given source folder.
 */
public void indexSourceFolder(JavaProject javaProject, IPath sourceFolder, final char[][] exclusionPattern) {
	IProject project = javaProject.getProject();
	if (this.jobEnd >= this.jobStart) {
		// check if a job to index the project is not already in the queue
		IndexRequest request = new IndexAllProject(project, this);
		for (int i = this.jobEnd; i >= this.jobStart; i--)
			if (request.equals(this.awaitingJobs[i])) return;
	}

	final IPath container = project.getFullPath();
	IContainer folder = container.equals(sourceFolder)
		? (IContainer) project
		 : (IContainer) ResourcesPlugin.getWorkspace().getRoot().getFolder(sourceFolder);
	try {
		folder.accept(new IResourceVisitor() {
			/*
			 * @see IResourceVisitor#visit(IResource)
			 */
			public boolean visit(IResource resource) throws CoreException {
				if (resource instanceof IFile) {
					if (org.eclipse.jdt.internal.core.Util.isJavaFileName(resource.getName()) 
							&& !org.eclipse.jdt.internal.core.Util.isExcluded(resource, exclusionPattern)) {
						addSource((IFile)resource, container);
					}
					return false;
				}
				return true;
			}
		});
	} catch (CoreException e) {
		// Folder does not exist.
		// It will be indexed only when DeltaProcessor detects its addition
	}
}

