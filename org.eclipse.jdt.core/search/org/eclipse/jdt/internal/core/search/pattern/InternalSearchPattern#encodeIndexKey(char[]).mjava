	protected char[] encodeIndexKey(char[] key) {
		// TODO (kent) with new index, need to encode key for case insensitive queries too
		// also want to pass along the entire pattern
		if (isCaseSensitive() && key != null) {
			switch(matchMode()) {
				case SearchPattern.R_EXACT_MATCH :
				case  SearchPattern.R_PREFIX_MATCH :
					return key;
				case  SearchPattern.R_PATTERN_MATCH :
					int starPos = CharOperation.indexOf('*', key);
					switch(starPos) {
						case -1 :
							return key;
						default : 
							char[] result = new char[starPos];
							System.arraycopy(key, 0, result, 0, starPos);
							return result;
						case 0 : // fall through
					}
					break;
				case  SearchPattern.R_REGEXP_MATCH:
					// TODO (jerome) implement
					return key;
			}
		}
		return CharOperation.NO_CHAR; // find them all
	}

