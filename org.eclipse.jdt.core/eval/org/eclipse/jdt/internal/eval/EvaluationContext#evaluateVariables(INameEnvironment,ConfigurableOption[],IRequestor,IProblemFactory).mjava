	/**
	 * @see org.eclipse.jdt.internal.eval.IEvaluationContext
	 * @exception org.eclipse.jdt.internal.eval.InstallException if the code snippet class files could not be deployed.
	 */
	public void evaluateVariables(
		INameEnvironment environment,
		ConfigurableOption[] options,
		IRequestor requestor,
		IProblemFactory problemFactory)
		throws InstallException {
		this.deployCodeSnippetClassIfNeeded(requestor);
		VariablesEvaluator evaluator =
			new VariablesEvaluator(this, environment, options, requestor, problemFactory);
		ClassFile[] classes = evaluator.getClasses();
		if (classes != null) {
			if (classes.length > 0) {
				// Send classes
				if (!requestor.acceptClassFiles(classes, null)) {
					throw new InstallException("Could not deploy classes for global variables");
				}

				// Remember that the variables have been installed
				int variableCount = this.variableCount;
				GlobalVariable[] variablesCopy = new GlobalVariable[variableCount];
				System.arraycopy(this.variables, 0, variablesCopy, 0, variableCount);
				this.installedVars =
					new VariablesInfo(
						evaluator.getPackageName(),
						evaluator.getClassName(),
						classes,
						variablesCopy,
						variableCount);
				VAR_CLASS_COUNTER++;
			}
			this.varsChanged = false;
		}
	}

