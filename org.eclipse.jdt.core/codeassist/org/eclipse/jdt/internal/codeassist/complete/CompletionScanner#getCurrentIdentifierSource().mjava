/* 
 * Truncate the current identifier if it is containing the cursor location. Since completion is performed
 * on an identifier prefix.
 *
 */
public char[] getCurrentIdentifierSource() {

	if (completionIdentifier == null){
		if (cursorLocation < startPosition && currentPosition == startPosition){ // fake empty identifier got issued
			// remember actual identifier positions
			completedIdentifierStart = startPosition;
			completedIdentifierEnd = completedIdentifierStart - 1;			
			return completionIdentifier = EmptyCompletionIdentifier;					
		}
		if (cursorLocation+1 >= startPosition && cursorLocation < currentPosition){
			// remember actual identifier positions
			completedIdentifierStart = startPosition;
			completedIdentifierEnd = currentPosition - 1;
			if (withoutUnicodePtr != 0){			// check unicode scenario
				System.arraycopy(withoutUnicodeBuffer, 1, completionIdentifier = new char[withoutUnicodePtr], 0, withoutUnicodePtr);
			} else {
				int length = cursorLocation + 1 - startPosition;
				// no char[] sharing around completionIdentifier, we want it to be unique so as to use identity checks	
				System.arraycopy(source, startPosition, (completionIdentifier = new char[length]), 0, length);
			}
			return completionIdentifier;
		}
	}
	return super.getCurrentIdentifierSource();
}

