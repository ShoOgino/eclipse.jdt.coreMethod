static Classpath getClasspath(String classpathName, String encoding, int mode, AccessRuleSet accessRuleSet) {
	Classpath result = null;
	File file = new File(convertPathSeparators(classpathName));
	if (file.isDirectory()) {
		if (file.exists()) {
			result = new ClasspathDirectory(file, encoding, mode, accessRuleSet);
		}
	} else {
		String lowercaseClasspathName = classpathName.toLowerCase();
		if (lowercaseClasspathName.endsWith(SUFFIX_STRING_jar)
				|| lowercaseClasspathName.endsWith(SUFFIX_STRING_zip)) {
			if (mode == ClasspathLocation.SOURCE) {
				// will throw an IOException if file does not exist
				result = new ClasspathSourceJar(file, true, accessRuleSet, encoding);			
			} else {
				// will throw an IOException if file does not exist
				result = new ClasspathJar(file, true, accessRuleSet);
			}
		}
	}
	return result;
}

