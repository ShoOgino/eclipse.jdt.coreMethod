	/**
	 * Creates and returns a new classpath entry of kind <code>CPE_LIBRARY</code> for the JAR or folder
	 * identified by the given absolute path. This specifies that all package fragments within the root 
	 * will have children of type <code>IClassFile</code>.
	 * <p>
	 * A library entry is used to denote a prerequisite JAR or root folder containing binaries.
	 * The target JAR can either be defined internally to the workspace (absolute path relative
	 * to the workspace root) or externally to the workspace (absolute path in the file system).
	 * The target root folder can only be defined internally to the workspace (absolute path relative
	 * to the workspace root). To use a binary folder external to the workspace, it must first be
	 * linked (see IFolder#createLink(...)).
	 * <p>
	 * e.g. Here are some examples of binary path usage<ul>
	 *	<li><code> "c:/jdk1.2.2/jre/lib/rt.jar" </code> - reference to an external JAR</li>
	 *	<li><code> "/Project/someLib.jar" </code> - reference to an internal JAR </li>
	 *	<li><code> "/Project/classes/" </code> - reference to an internal binary folder</li>
	 * </ul>
	 * Note that this operation does not attempt to validate or access the 
	 * resources at the given paths.
	 * <p>
	 * The accessible files patterns determines the initial set of accessible class files in 
	 * the library; the non accessible files patterns are then used to reduce this
	 * set. A class file that is not accessible can still be refered to but it is 
	 * tagged as being not accessible - the Java builder will create a problem 
	 * marker for example. The severity of this marker is controled through
	 * the {@link #COMPILER_PB_FORBIDDEN_REFERENCE} compiler option.
	 * Note this is different from inclusion and 
	 * exclusion patterns on source classpath entries, where a source file that
	 * is excluded is not even compiled.
	 * When no accessible files patterns are specified, all class files
	 * in the resource tree (or in the jar file) rooted at the library
	 * entry's path are initially accessible. On the other hand, specifying one 
	 * or more accessible files patterns means that all <b>and only</b> class 
	 * files matching at least one of the specified patterns are accessible. 
	 * If non accessible files patterns are specified, the initial set of accessible class files is 
	 * then reduced by eliminating class files matched by at least one of 
	 * the non accessible files patterns. Accessible files and non accessible files patterns look like 
	 * relative file paths with wildcards and are interpreted relative to the 
	 * library entry's path. Patterns are case-sensitive and they can 
	 * contain '**', '*' or '?' wildcards (see 
	 * {@link IClasspathEntry#getExclusionPatterns()} for the full description
	 * of their syntax and semantics).
	 * </p>
	 * <p>
	 * For example, if the library path is 
	 * <code>/Project/someLib.jar</code>, there are no accessible files filters, and the
	 * non accessible files pattern is 
	 * <code>com/xyz/tests/&#42;&#42;</code>, then class files
	 * like <code>/Project/someLib.jar/com/xyz/Foo.class</code>
	 * and <code>/Project/someLib.jar/com/xyz/utils/Bar.class</code> would be accessible,
	 * whereas <code>/Project/someLib.jar/com/xyz/tests/T1.class</code>
	 * and <code>/Project/someLib.jar/com/xyz/tests/quick/T2.class</code> would not be
	 * accessible. 
	 * </p>
	 * <p>
	 * The <code>extraAttributes</code> list contains name/value pairs that must be persisted with
	 * this entry. If no extra attributes are provided, an empty array must be passed in.
	 * </p>
	 * <p>
	 * The <code>isExported</code> flag indicates whether this entry is contributed to dependent
	 * projects. If not exported, dependent projects will not see any of the classes from this entry.
	 * If exported, dependent projects will concatenate the accessible files patterns of this entry with the
	 * accessible files patterns of the projects, and they will concatenate the non accessible files patterns of this entry
	 * with the non accessible files patterns of the project. 
	 * </p>
	 * 
	 * @param path the absolute path of the binary archive
	 * @param sourceAttachmentPath the absolute path of the corresponding source archive or folder, 
	 *    or <code>null</code> if none. Note, since 3.0, an empty path is allowed to denote no source attachment.
	 *   and will be automatically converted to <code>null</code>.
	 * @param sourceAttachmentRootPath the location of the root within the source archive or folder
	 *    or <code>null</code> if this location should be automatically detected.
	 * @param accessibleFiles the possibly empty list of accessible files patterns
	 *    represented as relative paths
	 * @param nonAccessibleFiles the possibly empty list of non accessible files patterns
	 *    represented as relative paths
	 * @param extraAttributes the possibly empty list of extra attributes to persist with this entry
	 * @param isExported indicates whether this entry is contributed to dependent
	 * 	  projects in addition to the output location
	 * @return a new library classpath entry
	 * @since 3.1
	 */
	public static IClasspathEntry newLibraryEntry(
			IPath path,
			IPath sourceAttachmentPath,
			IPath sourceAttachmentRootPath,
			IPath[] accessibleFiles, 
			IPath[] nonAccessibleFiles, 
			IClasspathAttribute[] extraAttributes,
			boolean isExported) {
			
		if (path == null) Assert.isTrue(false, "Library path cannot be null"); //$NON-NLS-1$
		if (!path.isAbsolute()) Assert.isTrue(false, "Path for IClasspathEntry must be absolute"); //$NON-NLS-1$
		if (sourceAttachmentPath != null) {
			if (sourceAttachmentPath.isEmpty()) {
				sourceAttachmentPath = null; // treat empty path as none
			} else if (!sourceAttachmentPath.isAbsolute()) {
				Assert.isTrue(false, "Source attachment path '" //$NON-NLS-1$
						+ sourceAttachmentPath
						+ "' for IClasspathEntry must be absolute"); //$NON-NLS-1$
			}
		}
		return new ClasspathEntry(
			IPackageFragmentRoot.K_BINARY,
			IClasspathEntry.CPE_LIBRARY,
			JavaProject.canonicalizedPath(path),
			ClasspathEntry.INCLUDE_ALL, // inclusion patterns
			ClasspathEntry.EXCLUDE_NONE, // exclusion patterns
			sourceAttachmentPath,
			sourceAttachmentRootPath,
			null, // specific output folder
			isExported,
			accessibleFiles,
			nonAccessibleFiles,
			extraAttributes);
	}

