	/**
	 * @see IBuffer
	 */
	public void save(IProgressMonitor progress, boolean force)
		throws JavaModelException {

		// determine if saving is required 
		if (isReadOnly() || fFile == null) {
			return;
		}
		synchronized (fLock) {
			if (!hasUnsavedChanges())
				return;
			byte[] bytes = getContents().getBytes();
			ByteArrayInputStream stream = new ByteArrayInputStream(bytes);

			// use a platform operation to update the resource contents
			try {
				fFile.setContents(stream, force, true, null); // record history
			} catch (CoreException e) {
				throw new JavaModelException(e);
			}

			// the resource no longer has unsaved changes
			fFlags &= ~(F_HAS_UNSAVED_CHANGES);
		}
	}

