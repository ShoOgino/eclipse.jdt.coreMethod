	/**
	 * Returns the <code>ICompilationUnit</code> which defines the type
	 * named <code>qualifiedTypeName</code>, or <code>null</code> if
	 * none exists. The domain of the search is bounded by the classpath
	 * of the <code>IJavaProject</code> this <code>NameLookup</code> was
	 * obtained from.
	 * <p>
	 * The name must be fully qualified (eg "java.lang.Object", "java.util.Hashtable$Entry")
	 */
	public ICompilationUnit findCompilationUnit(String qualifiedTypeName) {
		String[] pkgName = CharOperation.NO_STRINGS;
		String cuName = qualifiedTypeName;

		int index= qualifiedTypeName.lastIndexOf('.');
		if (index != -1) {
			pkgName= Util.splitOn('.', qualifiedTypeName, 0, index);
			cuName= qualifiedTypeName.substring(index + 1);
		}
		index= cuName.indexOf('$');
		if (index != -1) {
			cuName= cuName.substring(0, index);
		}
		IPackageFragmentRoot[] roots = (IPackageFragmentRoot[]) this.packageFragments.get(pkgName);
		if (roots != null) {
			for (int i= 0; i < roots.length; i++) {
				PackageFragmentRoot root= (PackageFragmentRoot) roots[i];
				if (!root.isArchive()) {
					IPackageFragment pkg = root.getPackageFragment(pkgName);
					try {
						ICompilationUnit[] cus = pkg.getCompilationUnits();
						for (int j = 0, length = cus.length; j < length; j++) {
							ICompilationUnit cu = cus[j];
							if (Util.equalsIgnoreJavaLikeExtension(cu.getElementName(), cuName))
								return cu;
						}
					} catch (JavaModelException e) {
						// pkg does not exist
						// -> try next package
					}
				}
			}
		}
		return null;
	}

