/**
 * Merged all awaiting deltas.
 */
public void mergeDeltas() {
	if (fJavaModelDeltas.size() <= 1) return;
	
	if (DeltaProcessor.VERBOSE) {
		System.out.println("MERGING " + fJavaModelDeltas.size() + " DELTAS ["+Thread.currentThread()+"]"); //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$
	}
	
	Iterator deltas = fJavaModelDeltas.iterator();
	IJavaElement javaModel = this.getJavaModel();
	JavaElementDelta rootDelta = new JavaElementDelta(javaModel);
	boolean insertedTree = false;
	while (deltas.hasNext()) {
		JavaElementDelta delta = (JavaElementDelta)deltas.next();
		if (DeltaProcessor.VERBOSE) {
			System.out.println(delta.toString());
		}
		IJavaElement element = delta.getElement();
		if (javaModel.equals(element)) {
			IJavaElementDelta[] children = delta.getAffectedChildren();
			for (int j = 0; j < children.length; j++) {
				JavaElementDelta projectDelta = (JavaElementDelta) children[j];
				rootDelta.insertDeltaTree(projectDelta.getElement(), projectDelta);
				insertedTree = true;
			}
		} else {
			rootDelta.insertDeltaTree(element, delta);
			insertedTree = true;
		}
	}
	if (insertedTree){
		fJavaModelDeltas = new ArrayList(1);
		fJavaModelDeltas.add(rootDelta);
	}
	else {
		fJavaModelDeltas = new ArrayList(0);
	}
}	

