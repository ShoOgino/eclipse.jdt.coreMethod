/**
 * @see Openable
 */
protected IBuffer openBuffer(IProgressMonitor pm) throws JavaModelException {

	IBuffer buffer;
	
	// request buffer factory
	if (this.bufferFactory != null) {
		buffer = this.bufferFactory.createBuffer(this);
		if (buffer != null){
			CompilationUnit original = (CompilationUnit) getOriginalElement();
			buffer.setContents(original.getContents());
			buffer.addBufferChangedListener(this);
			return buffer;
		}
	} 
	// create default buffer
	ICompilationUnit original= (ICompilationUnit)this.getOriginalElement();
	buffer = getBufferManager().openBuffer((char[])original.getBuffer().getCharacters().clone(), pm, this, isReadOnly());
	buffer.addBufferChangedListener(this);
	return buffer;	
}

