/**
 * @see IWorkingCopy
 */
public IJavaElement findSharedWorkingCopy(IBufferFactory factory) {

	// In order to be shared, working copies have to denote the same compilation unit 
	// AND use the same buffer factory.
	// Assuming there is a little set of buffer factories, then use a 2 level Map cache.
	Map sharedWorkingCopies = JavaModelManager.getJavaModelManager().sharedWorkingCopies;
	
	Map perFactoryWorkingCopies = 
		factory == null 
			?(Map) sharedWorkingCopies.get(CompilationUnit.DEFAULT_FACTORY) 
			: (Map) sharedWorkingCopies.get(factory);
	if (perFactoryWorkingCopies == null) return null;
	return (WorkingCopy)perFactoryWorkingCopies.get(this);
}

