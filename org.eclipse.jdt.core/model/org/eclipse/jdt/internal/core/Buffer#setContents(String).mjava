/**
 * @see IBuffer
 */
public void setContents(String newContents) {
	// allow special case for first initialization 
	// after creation by buffer factory
	if (this.contents == null) {
		this.contents = newContents.toCharArray();
		this.flags &= ~ (F_HAS_UNSAVED_CHANGES);
		return;
	}
	
	if (!isReadOnly()) {
		char[] charContents = null;
		if (newContents != null) {
			charContents = newContents.toCharArray();
		}
		BufferChangedEvent event = new BufferChangedEvent(this, 0, this.getLength(), newContents);
		synchronized (this.lock) {
			this.contents = charContents;
			this.flags |= F_HAS_UNSAVED_CHANGES;
			this.gapStart = -1;
			this.gapEnd = -1;
		}
		notifyChanged(event);
	}
}

