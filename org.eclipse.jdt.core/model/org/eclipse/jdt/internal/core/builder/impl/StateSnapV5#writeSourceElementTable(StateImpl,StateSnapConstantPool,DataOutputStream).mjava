/** 
 * Write the source element table.
 */
protected void writeSourceElementTable(StateImpl state, StateSnapConstantPool pool, DataOutputStream out) throws IOException {
	out.writeUTF("SourceElementTable"/*nonNLS*/);
	SourceElementTable table = state.getSourceElementTable();
	int num = table.numPackages();
	out.writeInt(num);
	for (Enumeration e = state.getPackageMap().getAllPackages(); e.hasMoreElements();) {
		IPackage pkg = (IPackage) e.nextElement();
		out.writeInt(pool.index(pkg));
		LookupTable entryTable = table.getPackageTable(pkg);
		out.writeInt(entryTable.size());
		for (Enumeration keys = entryTable.keys(); keys.hasMoreElements();) {
			String fileName = (String) keys.nextElement();
			out.writeInt(pool.index(fileName));
			SourceEntry sEntry = (SourceEntry) entryTable.get(fileName);
			out.writeInt(pool.index(sEntry));
		}
	}
}

