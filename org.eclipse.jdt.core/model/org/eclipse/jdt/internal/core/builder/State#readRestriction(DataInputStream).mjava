private static AccessRuleSet readRestriction(DataInputStream in) throws IOException {
	int length = in.readInt();
	if (length == 0) return null; // no restriction specified
	AccessRule[] accessRules = new AccessRule[length];
	for (int i = 0; i < length; i++) {
		char[] pattern = readName(in);
		int problemId = in.readInt();
		accessRules[i] = new ClasspathAccessRule(pattern, problemId);
	}
	String[] messageTemplates = new String[AccessRuleSet.MESSAGE_TEMPLATES_LENGTH];
	for (int i = 0; i < 3; i++) {
		messageTemplates[i] = in.readUTF();
	}
	AccessRuleSet accessRuleSet = new AccessRuleSet(accessRules);
	accessRuleSet.messageTemplates = messageTemplates;
	return accessRuleSet;
}

