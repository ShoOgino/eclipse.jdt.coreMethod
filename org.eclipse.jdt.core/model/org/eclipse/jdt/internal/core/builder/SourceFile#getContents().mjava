public char[] getContents() {
	// otherwise retrieve it
	InputStreamReader reader = null;
	try {
		reader =
			this.encoding == null
				? new InputStreamReader(resource.getContents())
				: new InputStreamReader(resource.getContents(), this.encoding);
		CharArrayBuffer result = new CharArrayBuffer();
		try {
			int count;
			char[] buffer = new char[4096];
			while ((count = reader.read(buffer, 0, buffer.length)) > -1)
				result.append(buffer, 0, count);
		} finally {
			reader.close();
		}
		return result.getContents();
	} catch (CoreException e) {
		throw new AbortCompilation(true, new MissingSourceFileException(resource.getFullPath().toString()));
	} catch (IOException e) {
		if (reader != null) {
			try { reader.close(); } catch(IOException ioe) {}
		}
		throw new AbortCompilation(true, new MissingSourceFileException(resource.getFullPath().toString()));
	}
}

