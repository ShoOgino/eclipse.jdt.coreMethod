	private IProject createExternalFoldersProject(IProgressMonitor monitor) throws CoreException {
		IProject project = getExternalFoldersProject();
		if (!project.isAccessible()) {
			if (!project.exists()) {
				createExternalFoldersProject(project, monitor);
			}
			try {
				project.open(monitor);
			} catch (CoreException e1) {
				if (e1.getStatus().getCode() == IResourceStatus.FAILED_READ_METADATA) {
					// workspace was moved (see https://bugs.eclipse.org/bugs/show_bug.cgi?id=241400)
					project.delete(true, monitor);
					createExternalFoldersProject(project, monitor);
				} else {
					// .project or folder on disk have been deleted, recreate them
					IPath stateLocation = DEBUG ? ResourcesPlugin.getWorkspace().getRoot().getLocation() : JavaCore.getPlugin().getStateLocation();
					IPath projectPath = stateLocation.append(EXTERNAL_PROJECT_NAME);
					projectPath.toFile().mkdirs();
					try {
					    FileOutputStream output = new FileOutputStream(projectPath.append(".project").toOSString()); //$NON-NLS-1$
					    try {
					        output.write((
					        		"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + //$NON-NLS-1$
					        		"<projectDescription>\n" + //$NON-NLS-1$
					        		"	<name>" + EXTERNAL_PROJECT_NAME + "</name>\n" + //$NON-NLS-1$ //$NON-NLS-2$
					        		"	<comment></comment>\n" + //$NON-NLS-1$
					        		"	<projects>\n" + //$NON-NLS-1$
					        		"	</projects>\n" + //$NON-NLS-1$
					        		"	<buildSpec>\n" + //$NON-NLS-1$
					        		"	</buildSpec>\n" + //$NON-NLS-1$
					        		"	<natures>\n" + //$NON-NLS-1$
					        		"	</natures>\n" + //$NON-NLS-1$
					        		"</projectDescription>").getBytes()); //$NON-NLS-1$
					    } finally {
					        output.close();
					    }
					} catch (IOException e) {
						// fallback to re-creating the project
						project.delete(true, monitor);
						createExternalFoldersProject(project, monitor);
					}
				}
				project.open(monitor);
			}
		}
		return project;
	}

