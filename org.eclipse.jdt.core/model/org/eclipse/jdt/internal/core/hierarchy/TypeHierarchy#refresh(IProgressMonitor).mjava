/**
 * @see ITypeHierarchy
 */
public void refresh(IProgressMonitor monitor) throws JavaModelException {
	try {
		boolean reactivate = isActivated();
		ArrayList listeners = fChangeListeners;
		if (reactivate) {
			deactivate();
		}
		fProgressMonitor = monitor;
		if (monitor != null) {
			monitor.beginTask(Util.bind("hierarchy.creating"), IProgressMonitor.UNKNOWN); //$NON-NLS-1$
		}
		long start = -1;
		if (DEBUG) {
			start = System.currentTimeMillis();
			System.out.println("CREATING TYPE HIERARCHY [" + Thread.currentThread() + "]"); //$NON-NLS-1$ //$NON-NLS-2$
			if (fType != null) {
				System.out.println("  on type " + ((JavaElement)fType).toStringWithAncestors()); //$NON-NLS-1$
			}
		}
		compute();
		if (reactivate) {
			activate();
			fChangeListeners = listeners;
		}
		if (monitor != null) {
			monitor.done();
		}
		fProgressMonitor = null;
		if (DEBUG) {
			System.out.println("CREATED TYPE HIERARCHY in " + (System.currentTimeMillis() - start) + "ms"); //$NON-NLS-1$ //$NON-NLS-2$
		}
	} catch (JavaModelException e) {
		fProgressMonitor = null;
		throw e;
	} catch (CoreException e) {
		fProgressMonitor = null;
		throw new JavaModelException(e);
	} catch (OperationCanceledException oce) {
		refreshCancelled(oce);
	}
}

