	private void updateMappedPositions(int startPosition) {
		if (positionsToMap == null) {
			return;
		}
		char[] source = scanner.source;
		int sourceLength = source.length;
		while (indexToMap < positionsToMap.length
			&& positionsToMap[indexToMap] <= startPosition) {
			int posToMap = positionsToMap[indexToMap];
			if (posToMap < 0
				|| posToMap >= sourceLength) { // protection against out of bounds position
				if (posToMap == sourceLength) {
					mappedPositions[indexToMap] = formattedSource.length();
				}
				indexToMap = positionsToMap.length; // no more mapping
				return;
			}
			if (Scanner.isWhitespace(source[posToMap])) {
				mappedPositions[indexToMap] = startPosition + globalDelta + lineDelta;
			} else {
				if (posToMap == sourceLength - 1) {
					mappedPositions[indexToMap] = startPosition + globalDelta + lineDelta;
				} else {
					mappedPositions[indexToMap] = posToMap + globalDelta + lineDelta;
				}
			}
			indexToMap++;
		}
	}

