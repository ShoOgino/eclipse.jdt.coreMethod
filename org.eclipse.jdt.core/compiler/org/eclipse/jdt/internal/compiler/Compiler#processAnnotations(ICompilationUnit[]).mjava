	protected void processAnnotations(ICompilationUnit[] sourceUnits) {
		int newUnitSize = 0;
		do {
			this.annotationProcessorManager.processAnnotations(unitsToProcess, false);
    		List newUnits = this.annotationProcessorManager.getNewUnits();
    		newUnitSize = newUnits.size();
    		ICompilationUnit[] newSourceUnits = sourceUnits;
    		if (newUnitSize != 0) {
    			// we reset the compiler in order to restart with the new units
    			this.reset();
    			int sourceUnitsLength = sourceUnits.length;
    			newSourceUnits = new ICompilationUnit[sourceUnitsLength + newUnitSize];
    			newUnits.toArray(newSourceUnits);
    			System.arraycopy(sourceUnits, 0, newSourceUnits, newUnitSize, sourceUnitsLength);
    			beginToCompile(newSourceUnits);
    			this.annotationProcessorManager.reset();
    		}
		} while (newUnitSize != 0);
		// one more loop to create possible resources
		// this loop cannot create any java source files
		this.annotationProcessorManager.processAnnotations(unitsToProcess, true);
		List newUnits = this.annotationProcessorManager.getNewUnits();
		if (newUnits.size() != 0) {
			// TODO report error
		}
	}

