	/**
	 * Select the first access rule which is violated when accessing a given type, or null if no 'non accessible' access rule applies.
	 * Target type file path is formed as: "org/eclipse/jdt/core/JavaCore.java".
	 */
	public AccessRestriction getViolatedRestriction(char[] targetTypeFilePath) {
		
		for (int i = 0, length = this.accessRules.length; i < length; i++) {
			AccessRule accessRule = this.accessRules[i];
			if (CharOperation.pathMatch(accessRule.pattern, targetTypeFilePath, true/*case sensitive*/, '/')) {
				switch (accessRule.problemId) {
					case IProblem.ForbiddenReference:
					case IProblem.DiscouragedReference:
						return new AccessRestriction(accessRule, this.messageTemplate);
					default:
						return null;
				}
			}
		}
		return null;
	}

