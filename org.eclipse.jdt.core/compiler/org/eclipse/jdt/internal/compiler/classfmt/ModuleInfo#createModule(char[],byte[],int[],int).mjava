	public static ModuleInfo createModule(char[] className, byte classFileBytes[], int offsets[], int offset) {

		int readOffset = offset;
//		module.name = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1)); // returns 'Module' 
		int moduleOffset = readOffset + 6;
		int utf8Offset;
		ModuleInfo module = new ModuleInfo(classFileBytes, offsets, 0);
		int name_index = module.constantPoolOffsets[module.u2At(moduleOffset)];
		utf8Offset = module.constantPoolOffsets[module.u2At(name_index + 1)];
		module.name = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
		CharOperation.replace(module.name, '/', '.');
		moduleOffset += 2;
		module.flags = module.u2At(moduleOffset);
		moduleOffset += 2;
		int version_index = module.u2At(moduleOffset);
		if (version_index > 0) {
			utf8Offset = module.constantPoolOffsets[version_index];
			module.version = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
		}
		moduleOffset += 2;

		utf8Offset = module.constantPoolOffsets[module.u2At(readOffset)];
		int count = module.u2At(moduleOffset);
		module.requiresCount = count;
		module.requires = new ModuleReferenceInfo[count];
		moduleOffset += 2;
		for (int i = 0; i < count; i++) {
			name_index = module.constantPoolOffsets[module.u2At(moduleOffset)];
			utf8Offset = module.constantPoolOffsets[module.u2At(name_index + 1)];
			char[] requiresNames = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
			module.requires[i] = module.new ModuleReferenceInfo();
			CharOperation.replace(requiresNames, '/', '.');
			module.requires[i].refName = requiresNames;
			moduleOffset += 2;
			int modifiers = module.u2At(moduleOffset);
			module.requires[i].modifiers = modifiers;
			module.requires[i].isTransitive = (ClassFileConstants.ACC_TRANSITIVE & modifiers) != 0; // Access modifier
			moduleOffset += 2;
			version_index = module.u2At(moduleOffset);
			if (version_index > 0) {
				utf8Offset = module.constantPoolOffsets[version_index];
				module.requires[i].required_version = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
			}
			moduleOffset += 2;
		}
		count = module.u2At(moduleOffset);
		moduleOffset += 2;
		module.exportsCount = count;
		module.exports = new PackageExportInfo[count];
		for (int i = 0; i < count; i++) {
			name_index = module.constantPoolOffsets[module.u2At(moduleOffset)];
			utf8Offset = module.constantPoolOffsets[module.u2At(name_index + 1)];
			char[] exported = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
			CharOperation.replace(exported, '/', '.');
			PackageExportInfo pack = module.new PackageExportInfo();
			module.exports[i] = pack;
			pack.packageName = exported;
			moduleOffset += 2;
			pack.modifiers = module.u2At(moduleOffset);
			moduleOffset += 2;
			int exportedtoCount = module.u2At(moduleOffset);
			moduleOffset += 2;
			if (exportedtoCount > 0) {
				pack.exportedTo = new char[exportedtoCount][];
				pack.exportedToCount = exportedtoCount;
				for(int k = 0; k < exportedtoCount; k++) {
					name_index = module.constantPoolOffsets[module.u2At(moduleOffset)];
					utf8Offset = module.constantPoolOffsets[module.u2At(name_index + 1)];
					char[] exportedToName = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
					CharOperation.replace(exportedToName, '/', '.');
					pack.exportedTo[k] = exportedToName;
					moduleOffset += 2;
				}
			}
		}
		count = module.u2At(moduleOffset);
		moduleOffset += 2;
		module.opensCount = count;
		module.opens = new PackageExportInfo[count];
		for (int i = 0; i < count; i++) {
			name_index = module.constantPoolOffsets[module.u2At(moduleOffset)];
			utf8Offset = module.constantPoolOffsets[module.u2At(name_index + 1)];
			char[] exported = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
			CharOperation.replace(exported, '/', '.');
			PackageExportInfo pack = module.new PackageExportInfo();
			module.opens[i] = pack;
			pack.packageName = exported;
			moduleOffset += 2;
			pack.modifiers = module.u2At(moduleOffset);
			moduleOffset += 2;
			int exportedtoCount = module.u2At(moduleOffset);
			moduleOffset += 2;
			if (exportedtoCount > 0) {
				pack.exportedTo = new char[exportedtoCount][];
				pack.exportedToCount = exportedtoCount;
				for(int k = 0; k < exportedtoCount; k++) {
					name_index = module.constantPoolOffsets[module.u2At(moduleOffset)];
					utf8Offset = module.constantPoolOffsets[module.u2At(name_index + 1)];
					char[] exportedToName = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
					CharOperation.replace(exportedToName, '/', '.');
					pack.exportedTo[k] = exportedToName;
					moduleOffset += 2;
				}
			}
		}
		count = module.u2At(moduleOffset);
		moduleOffset += 2;
		module.usesCount = count;
		module.uses = new char[count][];
		for (int i = 0; i < count; i++) {
			int classIndex = module.constantPoolOffsets[module.u2At(moduleOffset)];
			utf8Offset = module.constantPoolOffsets[module.u2At(classIndex + 1)];
			char[] inf = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
			CharOperation.replace(inf, '/', '.');
			module.uses[i] = inf;
			moduleOffset += 2;
		}
		count = module.u2At(moduleOffset);
		moduleOffset += 2;
		module.providesCount = count;
		module.provides = new ServiceInfo[count];
		for (int i = 0; i < count; i++) {
			int classIndex = module.constantPoolOffsets[module.u2At(moduleOffset)];
			utf8Offset = module.constantPoolOffsets[module.u2At(classIndex + 1)];
			char[] inf = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
			CharOperation.replace(inf, '/', '.');
			ServiceInfo service = module.new ServiceInfo();
			module.provides[i] = service;
			service.serviceName = inf;
			moduleOffset += 2;
			int implCount = module.u2At(moduleOffset);
			moduleOffset += 2;
			service.with = new char[implCount][];
			if (implCount > 0) {
				service.with = new char[implCount][];
				for(int k = 0; k < implCount; k++) {
					classIndex = module.constantPoolOffsets[module.u2At(moduleOffset)];
					utf8Offset = module.constantPoolOffsets[module.u2At(classIndex + 1)];
					char[] implName = module.utf8At(utf8Offset + 3, module.u2At(utf8Offset + 1));
					CharOperation.replace(implName, '/', '.');
					service.with[k] = implName;
					moduleOffset += 2;
				}
			}
		}
		return module;
	}

