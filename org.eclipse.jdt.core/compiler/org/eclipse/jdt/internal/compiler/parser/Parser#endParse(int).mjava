	protected CompilationUnitDeclaration endParse(int act) {

		this.lastAct = act;

		if (currentElement != null) {
			currentElement.topElement().updateParseTree();
			if (VERBOSE_RECOVERY) {
				System.out.println("SYNTAX RECOVERY--------------------------");
				System.out.println(compilationUnit);
				System.out.println("----------------------------------");
			}
		} else {
			if (diet & VERBOSE_RECOVERY) {
				System.out.println("REGULAR PARSE--------------------------");
				System.out.println(compilationUnit);
				System.out.println("----------------------------------");
			}
		}
		if (scanner.recordLineSeparator) {
			compilationUnit.compilationResult.lineSeparatorPositions = scanner.lineEnds();
		}
		return compilationUnit;
	}

