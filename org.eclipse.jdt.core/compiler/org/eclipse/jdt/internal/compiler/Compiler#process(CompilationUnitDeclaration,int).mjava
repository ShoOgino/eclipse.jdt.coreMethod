	/**
	 * Process a compilation unit already parsed and build.
	 */
	private void process(CompilationUnitDeclaration unit, int i) {

		getMethodBodies(unit, i);

		// fault in fields & methods
		if (unit.scope != null)
			unit.scope.faultInTypes();

		// verify inherited methods
		if (unit.scope != null)
			unit.scope.verifyMethods(lookupEnvironment.methodVerifier());

		// type checking
		long startTime = System.currentTimeMillis();
		unit.resolve();

		// flow analysis
		startTime = System.currentTimeMillis();
		unit.analyseCode();

		// code generation
		startTime = System.currentTimeMillis();
		unit.generateCode();

		// reference info
		if (options.produceReferenceInfo && unit.scope != null)
			unit.scope.storeDependencyInfo();

		// refresh the total number of units known at this stage
		unit.compilationResult.totalUnitsKnown = totalUnits;
	}

