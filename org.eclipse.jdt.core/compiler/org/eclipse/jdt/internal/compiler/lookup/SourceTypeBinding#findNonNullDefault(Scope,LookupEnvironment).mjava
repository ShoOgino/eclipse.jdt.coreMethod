/**
 * Answer the nullness default applicable at the given method binding.
 * Possible values: {@link Binding#NO_NULL_DEFAULT}, {@link Binding#NULL_UNSPECIFIED_BY_DEFAULT}, {@link Binding#NONNULL_BY_DEFAULT}.
 * @param currentScope where to start search for lexically enclosing default
 * @param environment gateway to options
 */
private int findNonNullDefault(Scope currentScope, LookupEnvironment environment) {
	// find the applicable default inside->out:

	SourceTypeBinding currentType = null;
	while (currentScope != null) {
		switch (currentScope.kind) {
			case Scope.METHOD_SCOPE:
				AbstractMethodDeclaration referenceMethod = ((MethodScope)currentScope).referenceMethod();
				if (referenceMethod != null && referenceMethod.binding != null) {
					long methodTagBits = referenceMethod.binding.tagBits;
					if ((methodTagBits & TagBits.AnnotationNonNullByDefault) != 0)
						return NONNULL_BY_DEFAULT;
					if ((methodTagBits & TagBits.AnnotationNullUnspecifiedByDefault) != 0)
						return NULL_UNSPECIFIED_BY_DEFAULT;
				}
				break;
			case Scope.CLASS_SCOPE:
				currentType = ((ClassScope)currentScope).referenceContext.binding;
				if (currentType != null) {
					int foundDefaultNullness = currentType.defaultNullness;
					if (foundDefaultNullness != NO_NULL_DEFAULT) {
						return foundDefaultNullness;
					}
				}
				break;
		}
		currentScope = currentScope.parent;
	}

	// package
	if (currentType != null) {
		int foundDefaultNullness = currentType.getPackage().defaultNullness;
		if (foundDefaultNullness != NO_NULL_DEFAULT) {
			return foundDefaultNullness;
		}
	}

	return NO_NULL_DEFAULT;
}

