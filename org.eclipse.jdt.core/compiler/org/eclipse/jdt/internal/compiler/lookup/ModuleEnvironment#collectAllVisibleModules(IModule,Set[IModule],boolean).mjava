	protected void collectAllVisibleModules(IModule module, Set<IModule> targets, boolean onlyPublic) {
		if (module != null) {
			IModuleDeclaration.IModuleReference[] requires = module.getDeclaration().requires();
			if (requires != null && requires.length > 0) {
				for (IModuleDeclaration.IModuleReference ref : requires) {
					IModule refModule = getModule(ref.name());
					if (refModule != null) {
						if (!onlyPublic || ref.isPublic()) {
							targets.add(refModule);
							collectAllVisibleModules(refModule, targets, true);
						}
					}
				}
			}
		}
	}

