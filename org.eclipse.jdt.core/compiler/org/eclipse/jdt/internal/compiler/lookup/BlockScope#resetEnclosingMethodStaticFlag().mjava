// https://bugs.eclipse.org/bugs/show_bug.cgi?id=318682
/**
 * This method is used to reset the CanBeStatic the enclosing method of the current block
 */
public void resetEnclosingMethodStaticFlag() {
	MethodScope methodScope = methodScope();
	while (methodScope != null && methodScope.referenceContext instanceof LambdaExpression) {
		LambdaExpression lambda = (LambdaExpression) methodScope.referenceContext;
		lambda.shouldCaptureInstance = true;
		methodScope = methodScope.enclosingMethodScope();
	}
	if (methodScope != null) {
		if (methodScope.referenceContext instanceof MethodDeclaration) {
			MethodDeclaration methodDeclaration = (MethodDeclaration) methodScope.referenceContext;
			methodDeclaration.bits &= ~ASTNode.CanBeStatic;
		} else if (methodScope.referenceContext instanceof TypeDeclaration) {
			// anonymous type, find enclosing method
			methodScope = methodScope.enclosingMethodScope();
			while (methodScope != null && methodScope.referenceContext instanceof LambdaExpression) {
				LambdaExpression lambda = (LambdaExpression) methodScope.referenceContext;
				lambda.shouldCaptureInstance = true;
				methodScope = methodScope.enclosingMethodScope();
			}
			if (methodScope != null && methodScope.referenceContext instanceof MethodDeclaration) {
				MethodDeclaration methodDeclaration = (MethodDeclaration) methodScope.referenceContext;
				methodDeclaration.bits &= ~ASTNode.CanBeStatic;
			}
		}
	}
}

