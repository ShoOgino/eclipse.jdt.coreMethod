	private void ensureResolved(BlockScope scope, Expression expr, TypeBinding targetType) {
		// TODO this method might be obsoleted by the use of LE.getResolvedCopyForInferenceTargeting()
		if (expr.resolvedType == null) {
			if (targetType.isProperType(true))
				expr.setExpectedType(targetType);
			else
				expr.setExpectedType(null);
			ExpressionContext previousExpressionContext = expr.getExpressionContext();
			if (previousExpressionContext == ExpressionContext.VANILLA_CONTEXT)
				expr.setExpressionContext(ExpressionContext.ASSIGNMENT_CONTEXT);
			try {
				expr.resolveType(scope);
			} finally {
				expr.setExpressionContext(previousExpressionContext);
			}
		}
	}

